{"version":3,"file":"middleware.js","sourceRoot":"","sources":["../src/middleware.ts"],"names":[],"mappings":";;;AAIO,IAAM,eAAe,GAAG,UAAC,OAAY,EAAE,GAAuB;IAAvB,oBAAA,EAAA,QAAuB;IACnE,IAAM,OAAO,GAAG,UAAC,OAAY,EAAE,GAAkB;QAC/C,IAAM,WAAW,GAAG,OAAO,CAAA;QAC3B,OAAO,OAAO,CAAC,OAAO,CACpB,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,UAAC,OAAO;YACtB,OAAA,OAAO,CAAC,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,WAAW,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAA7C,CAA6C,CAC9C,CACF,CAAA;IACH,CAAC,CAAA;IACD,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QACjC,OAAO,CACL,OAAO,EACP,GAAG,CAAC,MAAM,CAAC,UAAC,OAAO;YACjB,OAAO,CAAC,OAAO,CAAC,CAAA;QAClB,CAAC,CAAC,CACH,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;IACjB,CAAC,CAAC,CAAA;AACJ,CAAC,CAAA;AAjBY,QAAA,eAAe,mBAiB3B","sourcesContent":["export interface IMiddleware<Payload = any, Result = any> {\r\n  (payload: Payload, next: (payload?: Payload) => Result): Result\r\n}\r\n\r\nexport const applyMiddleware = (payload: any, fns: IMiddleware[] = []) => {\r\n  const compose = (payload: any, fns: IMiddleware[]): Promise<any> => {\r\n    const prevPayload = payload\r\n    return Promise.resolve(\r\n      fns[0](payload, (payload) =>\r\n        compose(payload ?? prevPayload, fns.slice(1))\r\n      )\r\n    )\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    compose(\r\n      payload,\r\n      fns.concat((payload) => {\r\n        resolve(payload)\r\n      })\r\n    ).catch(reject)\r\n  })\r\n}\r\n"]}